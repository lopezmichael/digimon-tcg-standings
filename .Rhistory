library(googlesheets4)
library(tidyverse)
dfw_standings <- read_sheet("https://docs.google.com/spreadsheets/d/10huFiVQEXd95UhpFuUap9LuIcIrnj_3hiHfr-b8CZ60/")
dfw_standings <- read_sheet("https://docs.google.com/spreadsheets/d/10huFiVQEXd95UhpFuUap9LuIcIrnj_3hiHfr-b8CZ60/")
dfw_standings <- read_sheet("https://docs.google.com/spreadsheets/d/10huFiVQEXd95UhpFuUap9LuIcIrnj_3hiHfr-b8CZ60/") %>%
pivot_longer(cols = starts_with("first_tamer"):starts_with("fourth_deck"),
names_to = c(".value", "placement"),
names_pattern = "(.*)_(.*)") %>%
rename(player_name = tamer, deck = deck)
dfw_standings <- read_sheet("https://docs.google.com/spreadsheets/d/10huFiVQEXd95UhpFuUap9LuIcIrnj_3hiHfr-b8CZ60/") %>%
pivot_longer(cols = starts_with("first_tamer"):starts_with("fourth_deck"),
names_to = c(".value", "placement"),
names_pattern = "(.*)_(.*)") #%>%
View(dfw_standings)
View(dfw_standings)
dfw_standings <- read_sheet("https://docs.google.com/spreadsheets/d/10huFiVQEXd95UhpFuUap9LuIcIrnj_3hiHfr-b8CZ60/") %>%
pivot_longer(cols = starts_with("first_tamer"):starts_with("fourth_deck"),
names_to = c("placement", ".value"),
names_pattern = "(.*)_(.*)")
View(dfw_standings)
dfw_standings <- read_sheet("https://docs.google.com/spreadsheets/d/10huFiVQEXd95UhpFuUap9LuIcIrnj_3hiHfr-b8CZ60/") %>%
pivot_longer(cols = starts_with("first_tamer"):starts_with("fourth_deck"),
names_to = c("placement", ".value"),
names_pattern = "(.*)_(.*)") %>%
rename(player_name = tamer, deck = deck)
View(dfw_standings)
# Load the necessary libraries
library(shiny)
library(tidyverse)
library(highcharter)
library(googlesheets4)
library(lubridate)
# Load the necessary libraries
library(shiny)
library(tidyverse)
library(highcharter)
library(googlesheets4)
library(lubridate)
# Load Standings Data and Pivot Longer for Tool
dfw_standings <- read_sheet("https://docs.google.com/spreadsheets/d/10huFiVQEXd95UhpFuUap9LuIcIrnj_3hiHfr-b8CZ60/") %>%
pivot_longer(cols = starts_with("first_tamer"):starts_with("fourth_deck"),
names_to = c("placement", ".value"),
names_pattern = "(.*)_(.*)") %>%
rename(player_name = tamer, deck = deck)
unique(dfw_standings$deck)
# Load the data (replace with your actual data source)
digimon_bosses <- read_sheet("https://docs.google.com/spreadsheets/d/1gW2hP9sTyv0An8FftPVfH73ui6-J5eHjfVc_1FNM73Y/") #%>%
View(digimon_bosses)
# Load Standings Data and Pivot Longer for Tool
dfw_standings <- read_sheet("https://docs.google.com/spreadsheets/d/10huFiVQEXd95UhpFuUap9LuIcIrnj_3hiHfr-b8CZ60/") %>%
pivot_longer(cols = starts_with("first_tamer"):starts_with("fourth_deck"),
names_to = c("placement", ".value"),
names_pattern = "(.*)_(.*)") %>%
rename(player_name = tamer, deck_name = deck)
View(dfw_standings)
dfw_bosses <- dfw_standings %>%
select(deck_name) %>%
mutate(card_set = NA,
card_id = NA)
# Load the data (replace with your actual data source)
digimon_bosses <- read_sheet("https://docs.google.com/spreadsheets/d/1gW2hP9sTyv0An8FftPVfH73ui6-J5eHjfVc_1FNM73Y/") %>%
rbind(., dfw_bosses)
View(digimon_bosses)
# Load the data (replace with your actual data source)
digimon_bosses <- read_sheet("https://docs.google.com/spreadsheets/d/1gW2hP9sTyv0An8FftPVfH73ui6-J5eHjfVc_1FNM73Y/") %>%
rbind(., dfw_bosses) %>%
distinct()
View(digimon_bosses)
dfw_bosses <- dfw_standings %>%
select(deck_name) %>%
mutate(card_set = NA,
card_id = NA,
boss_card = NA)
# Load the data (replace with your actual data source)
digimon_bosses <- read_sheet("https://docs.google.com/spreadsheets/d/1gW2hP9sTyv0An8FftPVfH73ui6-J5eHjfVc_1FNM73Y/") %>%
rbind(., dfw_bosses) %>%
distinct()
sheet_write(digimon_bosses, ss = "https://docs.google.com/spreadsheets/d/1gW2hP9sTyv0An8FftPVfH73ui6-J5eHjfVc_1FNM73Y/")
gs4_auth()
gs4_auth()
sheet_write(digimon_bosses, ss = "https://docs.google.com/spreadsheets/d/1gW2hP9sTyv0An8FftPVfH73ui6-J5eHjfVc_1FNM73Y/")
gs4_auth()
sheet_write(digimon_bosses, ss = "https://docs.google.com/spreadsheets/d/1gW2hP9sTyv0An8FftPVfH73ui6-J5eHjfVc_1FNM73Y/")
# Load the data (replace with your actual data source)
digimon_bosses <- read_sheet("https://docs.google.com/spreadsheets/d/1gW2hP9sTyv0An8FftPVfH73ui6-J5eHjfVc_1FNM73Y/",
sheet = "digimon_bosses") %>%
#  rbind(., dfw_bosses) %>%
#  distinct()
#sheet_write(digimon_bosses, ss = "https://docs.google.com/spreadsheets/d/1gW2hP9sTyv0An8FftPVfH73ui6-J5eHjfVc_1FNM73Y/",
#            sheet = "digimon_bosses")
mutate(image_url = paste0("https://images.digimoncard.io/images/cards/", card_id, ".jpg"))
View(digimon_bosses)
# Load the data (replace with your actual data source)
digimon_bosses <- read_sheet("https://docs.google.com/spreadsheets/d/1gW2hP9sTyv0An8FftPVfH73ui6-J5eHjfVc_1FNM73Y/",
sheet = "digimon_bosses") %>%
#  rbind(., dfw_bosses) %>%
#  distinct()
#sheet_write(digimon_bosses, ss = "https://docs.google.com/spreadsheets/d/1gW2hP9sTyv0An8FftPVfH73ui6-J5eHjfVc_1FNM73Y/",
#            sheet = "digimon_bosses")
mutate(image_url = paste0("https://images.digimoncard.io/images/cards/", card_id, ".jpg")) %>%
filter(!is.na(card_id))
# Ensure that the 'deck' column matches for the join
standings  <- rio::import("data/Fake_Digimon_TCG_Dataset.csv") %>%
rename(deck_name = deck, format_type = format, tournament_date = tournament_day) %>%
mutate(tournament_date = lubridate::mdy(tournament_date))
# Join standings with digimon_bosses by deck_name and ensure the image_url column is included
standings_enrich <- left_join(standings, digimon_bosses, by = "deck_name")
# Ensure image_url exists after join
if (!"image_url" %in% colnames(standings_enrich)) {
stop("The image_url column does not exist in the dataset. Please check the join operation.")
}
# Function to calculate top 3 placements and weighted standings
calculate_weighted_points <- function(df) {
df %>%
mutate(points = case_when(
placement == 1 ~ 3,
placement == 2 ~ 2,
placement == 3 ~ 1,
TRUE ~ 0
))
}
# UI for the Shiny App
ui <- fluidPage(
titlePanel("Digimon TCG Dashboard"),
sidebarLayout(
sidebarPanel(
# Default 'format' to NULL, so all formats are selected
selectInput("format", "Choose Format:", choices = unique(standings_enrich$format_type), selected = NULL, multiple = TRUE),
# Default date range to cover the entire date range of the dataset
dateRangeInput("date_range", "Choose Date Range:",
start = min(standings_enrich$tournament_date),
end = max(standings_enrich$tournament_date),
min = min(standings_enrich$tournament_date),
max = max(standings_enrich$tournament_date)),
radioButtons("view_type", "View Standings By:", choices = list("Raw Count" = "raw", "Weighted" = "weighted"), selected = "raw"),
# Add tables below the filter options
h3("Top Placements by Players"),
tableOutput("top_players_table"),
h3("Top Placements by Deck"),
tableOutput("top_decks_table")
),
mainPanel(
# Arrange the pie chart and line chart next to each other
fluidRow(
column(6, highchartOutput("deck_pie_chart")),
column(6, highchartOutput("deck_line_chart"))
)
)
)
)
# Server for the Shiny App
server <- function(input, output) {
# Filtered Data based on user input (if no filter, default to all data)
filtered_data <- reactive({
data <- standings_enrich
if (!is.null(input$format) && length(input$format) > 0) {
data <- data %>% filter(format_type %in% input$format)
}
data <- data %>%
filter(tournament_date >= input$date_range[1],
tournament_date <= input$date_range[2])
return(data)
})
# Calculate the pie chart data
output$deck_pie_chart <- renderHighchart({
data <- filtered_data() %>%
count(deck_name, image_url) %>%
mutate(percent = n / sum(n) * 100)
pie_list <- list_parse(data %>%
select(name = deck_name, y = n, image_url))
# Adjust for images in the pie chart
for (k in seq_along(pie_list)) {
pie_list[[k]]$color <- list(pattern = list(
image = pie_list[[k]]$image_url,
aspectRatio = 1/2,
x = 0,
y = 0
))
}
highchart() %>%
hc_chart(type = "pie") %>%
hc_add_series(data = pie_list) %>%
hc_add_dependency("modules/pattern-fill.js") %>%
hc_plotOptions(pie = list(
showInLegend = TRUE,
dataLabels = list(
enabled = TRUE,
format = '{point.name}<br>{point.percent}%',
style = list(fontSize = '12px')
)
)) %>%
hc_tooltip(enabled = FALSE) %>%
hc_title(text = "Top Placements by Deck")
})
# Table: Top players based on top 3 placements
output$top_players_table <- renderTable({
data <- filtered_data() %>%
calculate_weighted_points() %>%
filter(placement <= 3) %>%
group_by(player_name) %>%
summarise(top_3_count = n(),
total_points = sum(points))
if (input$view_type == "raw") {
data %>%
arrange(desc(top_3_count))
} else {
data %>%
arrange(desc(total_points))
}
})
# Table: Top decks based on top 3 placements
output$top_decks_table <- renderTable({
data <- filtered_data() %>%
calculate_weighted_points() %>%
filter(placement <= 3) %>%
group_by(deck_name) %>%
summarise(top_3_count = n(),
total_points = sum(points))
if (input$view_type == "raw") {
data %>%
arrange(desc(top_3_count))
} else {
data %>%
arrange(desc(total_points))
}
})
# Line Chart: Total placements by deck over time
output$deck_line_chart <- renderHighchart({
data <- filtered_data() %>%
group_by(deck_name, tournament_date) %>%
summarise(total_placements = sum(placement))
highchart() %>%
hc_xAxis(type = "datetime") %>%
hc_add_series(data, type = "line", hcaes(x = tournament_date, y = total_placements, group = deck_name)) %>%
hc_title(text = "Top Placements Over Time")
})
}
# Run the Shiny App
shinyApp(ui, server)
